<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>14.3.2 - Tipuri de Miss-uri</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/lesson.css">
</head>
<body>
    <article class="lesson-container">
        <header class="lesson-header">
            <span class="lesson-badge">LecÈ›ia 14.3.2</span>
            <h1 class="lesson-title">Tipuri de Miss-uri</h1>
            <p class="lesson-subtitle">Clasificarea "3 C" a miss-urilor de cache</p>
        </header>

        <section class="section" id="introducere">
            <h2 class="section-title">Modelul "3 C"</h2>
            <p class="text-content">
                Pentru a Ã®nÈ›elege È™i optimiza performanÈ›a cache-ului, miss-urile sunt clasificate 
                Ã®n trei categorii principale, cunoscute ca <strong>modelul 3 C</strong> (Three C's model), 
                propus de Mark Hill. ÃnÈ›elegerea cauzelor miss-urilor permite alegerea strategiilor 
                optime de optimizare.
            </p>
            <figure class="figure">
                <a href="../images/F75.png" target="_blank">
                    <img src="../images/F75.png" alt="Handshaking iniÈ›iat de sursÄƒ" class="figure-img medium">
                </a>
                <figcaption class="figure-caption">
                    <strong>Figura 7.5:</strong> Diagrama bloc ÅŸi evoluÅ£ia semnalelor Ã®n timp pentru transfer de tip handshaking iniÅ£iat de sursa datelor.
                </figcaption>
            </figure>
        </section>

        <section class="section" id="compulsory">
            <h2 class="section-title">1. Compulsory Misses (Miss-uri Obligatorii)</h2>
            
            <div class="definition-box">
                <p class="definition-label">DefiniÈ›ie</p>
                <p class="definition-text">
                    <strong>Compulsory miss</strong> (sau "cold miss" / "first-reference miss") 
                    apare atunci cÃ¢nd un bloc este accesat pentru <strong>prima datÄƒ</strong>. 
                    Blocul nu poate fi Ã®n cache deoarece nu a fost niciodatÄƒ accesat anterior.
                </p>
            </div>

            <div class="info-box info-blue">
                <p class="info-title">ğŸ“Š Caracteristici</p>
                <ul class="content-list">
                    <li>Inevitabile - apar chiar È™i cu cache infinit de mare</li>
                    <li>Depind de dimensiunea working set-ului programului</li>
                    <li>Apar la pornirea programului sau la intrarea Ã®n zone noi de cod/date</li>
                </ul>
            </div>

            <h3>Strategii de Reducere:</h3>
            <ul class="content-list">
                <li><strong>Prefetching:</strong> Aducerea anticipatÄƒ a blocurilor Ã®n cache</li>
                <li><strong>Linii de cache mai mari:</strong> Aduc mai multe date odatÄƒ (exploateazÄƒ localitatea spaÈ›ialÄƒ)</li>
                <li><strong>Compilatoare optimizate:</strong> ReorganizeazÄƒ accesurile pentru a minimiza prima utilizare</li>
            </ul>
            <figure class="figure">
                <a href="../images/F76.png" target="_blank">
                    <img src="../images/F76.png" alt="Handshaking iniÈ›iat de destinaÈ›ie" class="figure-img medium">
                </a>
                <figcaption class="figure-caption">
                    <strong>Figura 7.6:</strong> Diagrama bloc ÅŸi evoluÅ£ia semnalelor Ã®n timp pentru transfer de tip handshaking iniÅ£iat de destinaÅ£ia datelor.
                </figcaption>
            </figure>
        </section>

        <section class="section" id="capacity">
            <h2 class="section-title">2. Capacity Misses (Miss-uri de Capacitate)</h2>
            
            <div class="definition-box">
                <p class="definition-label">DefiniÈ›ie</p>
                <p class="definition-text">
                    <strong>Capacity miss</strong> apare atunci cÃ¢nd cache-ul nu poate conÈ›ine 
                    toate blocurile necesare pentru a executa programul, È™i un bloc care va fi 
                    necesar din nou a fost eliminat pentru a face loc altui bloc.
                </p>
            </div>

            <div class="info-box info-blue">
                <p class="info-title">ğŸ“Š Caracteristici</p>
                <ul class="content-list">
                    <li>Depind de dimensiunea cache-ului relativ la working set</li>
                    <li>Ar apÄƒrea chiar È™i Ã®ntr-un cache complet asociativ de aceeaÈ™i dimensiune</li>
                    <li>ReprezintÄƒ "overflow-ul" cache-ului</li>
                </ul>
            </div>

            <h3>Strategii de Reducere:</h3>
            <ul class="content-list">
                <li><strong>Cache-uri mai mari:</strong> SoluÈ›ia directÄƒ, dar costisitoare</li>
                <li><strong>Optimizarea codului:</strong> Reducerea working set-ului activ</li>
                <li><strong>Loop tiling/blocking:</strong> ÃmpÄƒrÈ›irea datelor pentru a Ã®ncÄƒpea Ã®n cache</li>
                <li><strong>Restructurarea datelor:</strong> Eliminarea datelor neutilizate</li>
            </ul>

            <div class="code-block">
<pre>// Exemplu: Loop Tiling pentru reducerea capacity misses
// Ãnainte (working set mare):
for (i = 0; i < N; i++)
    for (j = 0; j < N; j++)
        C[i][j] = A[i][j] + B[i][j];

// DupÄƒ (working set mai mic la un moment dat):
for (ii = 0; ii < N; ii += BLOCK)
    for (jj = 0; jj < N; jj += BLOCK)
        for (i = ii; i < min(ii+BLOCK, N); i++)
            for (j = jj; j < min(jj+BLOCK, N); j++)
                C[i][j] = A[i][j] + B[i][j];</pre>
            </div>
        </section>

        <section class="section" id="conflict">
            <h2 class="section-title">3. Conflict Misses (Miss-uri de Conflict)</h2>
            
            <div class="definition-box">
                <p class="definition-label">DefiniÈ›ie</p>
                <p class="definition-text">
                    <strong>Conflict miss</strong> (sau "collision miss") apare Ã®n cache-uri cu 
                    mapare directÄƒ sau set-asociativÄƒ atunci cÃ¢nd mai multe blocuri competesc 
                    pentru aceeaÈ™i locaÈ›ie sau set, chiar dacÄƒ alte locaÈ›ii din cache sunt libere.
                </p>
            </div>

            <div class="info-box info-blue">
                <p class="info-title">ğŸ“Š Caracteristici</p>
                <ul class="content-list">
                    <li>Nu ar apÄƒrea Ã®ntr-un cache complet asociativ de aceeaÈ™i dimensiune</li>
                    <li>Cauzate de limitÄƒrile scheme de mapare</li>
                    <li>Pot duce la "thrashing" - Ã®nlocuire repetatÄƒ a aceloraÈ™i blocuri</li>
                </ul>
            </div>

            <h3>Strategii de Reducere:</h3>
            <ul class="content-list">
                <li><strong>CreÈ™terea asociativitÄƒÈ›ii:</strong> De la direct-mapped la N-way</li>
                <li><strong>Victim cache:</strong> Cache mic complet asociativ pentru blocuri eliminate</li>
                <li><strong>Reorganizarea datelor:</strong> Padding pentru a evita conflictele</li>
                <li><strong>Compiler hints:</strong> Alinierea datelor pentru a evita maparea la acelaÈ™i set</li>
            </ul>

            <div class="code-block">
<pre>// Exemplu: Conflict miss datorat stride-ului
// DacÄƒ A È™i B au adrese care se mapeazÄƒ la acelaÈ™i set:
for (i = 0; i < N; i++) {
    suma += A[i] + B[i];  // A[i] È™i B[i] se Ã®nlocuiesc reciproc!
}

// SoluÈ›ie: Padding
float A[N + PADDING];  // SchimbÄƒ alinierea
float B[N];            // Acum se mapeazÄƒ la seturi diferite</pre>
            </div>
        </section>

        <section class="section" id="coherency">
            <h2 class="section-title">Bonus: Coherency Misses (4th C)</h2>
            
            <p class="text-content">
                Ãn sistemele multiprocesor, existÄƒ o a patra categorie de miss-uri:
            </p>

            <div class="definition-box">
                <p class="definition-label">DefiniÈ›ie</p>
                <p class="definition-text">
                    <strong>Coherency miss</strong> apare atunci cÃ¢nd un bloc este invalidat 
                    din cache din cauza unei scrieri de alt procesor Ã®n sistemele cu memorie 
                    partajatÄƒ. Cunoscut È™i ca "communication miss" sau "invalidation miss".
                </p>
            </div>

            <div class="info-box">
                <p class="info-title">ğŸ’¡ Ãn Sistemele Multi-Core</p>
                <p>
                    DacÄƒ CPU1 modificÄƒ variabila X, cache-ul CPU2 care conÈ›ine X trebuie invalidat 
                    (protocol MESI/MOESI). UrmÄƒtorul acces al CPU2 la X va fi un coherency miss.
                </p>
            </div>
        </section>

        <section class="section" id="comparatie">
            <h2 class="section-title">Sumar Comparativ</h2>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Tip Miss</th>
                        <th>CauzÄƒ</th>
                        <th>SoluÈ›ie PrincipalÄƒ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Compulsory</strong></td>
                        <td>Primul acces la bloc</td>
                        <td>Prefetching, linii mai mari</td>
                    </tr>
                    <tr>
                        <td><strong>Capacity</strong></td>
                        <td>Cache prea mic</td>
                        <td>Cache mai mare, loop tiling</td>
                    </tr>
                    <tr>
                        <td><strong>Conflict</strong></td>
                        <td>CompetiÈ›ie pentru set/linie</td>
                        <td>Asociativitate mai mare</td>
                    </tr>
                    <tr>
                        <td><strong>Coherency</strong></td>
                        <td>Invalidare de alt CPU</td>
                        <td>Optimizarea partajÄƒrii</td>
                    </tr>
                </tbody>
            </table>

            <div class="card-grid">
                <div class="info-card">
                    <div class="card-icon">ğŸ“ˆ</div>
                    <h3 class="card-title">DistribuÈ›ie TipicÄƒ</h3>
                    <p class="card-text">
                        Pentru aplicaÈ›ii tipice:<br>
                        â€¢ Compulsory: 1-5%<br>
                        â€¢ Capacity: 20-40%<br>
                        â€¢ Conflict: 20-50%<br>
                        (variazÄƒ mult cu aplicaÈ›ia)
                    </p>
                </div>
                <div class="info-card">
                    <div class="card-icon">ğŸ¯</div>
                    <h3 class="card-title">Identificare</h3>
                    <p class="card-text">
                        Simulatoare de cache pot clasifica miss-urile comparÃ¢nd cu un cache ideal 
                        (complet asociativ, infinit) pentru a determina care C contribuie mai mult.
                    </p>
                </div>
            </div>
        </section>

        <section class="section" id="sumar">
            <h2 class="section-title">Rezumat</h2>
            <div class="info-box info-green">
                <p class="info-title">ğŸ“ Puncte Cheie</p>
                <ul class="content-list">
                    <li><strong>Compulsory:</strong> Prima referinÈ›Äƒ la un bloc - inevitabil</li>
                    <li><strong>Capacity:</strong> Working set depÄƒÈ™eÈ™te capacitatea cache-ului</li>
                    <li><strong>Conflict:</strong> Blocuri care competesc pentru acelaÈ™i set</li>
                    <li><strong>Coherency:</strong> Invalidare Ã®n sisteme multiprocesor</li>
                    <li>SoluÈ›ii diferite pentru tipuri diferite de miss-uri</li>
                </ul>
            </div>
        </section>
    </article>

    <script src="../../js/lesson.js"></script>
</body>
</html>
