<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>13.3.3 - OptimizÄƒri Cache</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/lesson.css">
</head>
<body>
    <article class="lesson-container">
        <header class="lesson-header">
            <span class="lesson-badge">LecÈ›ia 13.3.3</span>
            <h1 class="lesson-title">OptimizÄƒri Cache</h1>
            <p class="lesson-subtitle">Tehnici pentru Ã®mbunÄƒtÄƒÈ›irea performanÈ›ei memoriei cache</p>
        </header>

        <section class="section" id="introducere">
            <h2 class="section-title">Strategii de Optimizare</h2>
            <p class="text-content">
                Amintim formula AMAT: <code class="code-inline">AMAT = Hit Time + Miss Rate Ã— Miss Penalty</code>. 
                OptimizÄƒrile cache vizeazÄƒ reducerea unuia sau mai multor termeni din aceastÄƒ ecuaÈ›ie.
            </p>

            <div class="card-grid">
                <div class="info-card">
                    <div class="card-icon">âš¡</div>
                    <h3 class="card-title">Reducere Hit Time</h3>
                    <p class="card-text">Cache-uri mici È™i simple, cÄƒi de acces directe</p>
                </div>
                <div class="info-card">
                    <div class="card-icon">ğŸ“‰</div>
                    <h3 class="card-title">Reducere Miss Rate</h3>
                    <p class="card-text">Cache-uri mai mari, asociativitate, prefetching</p>
                </div>
                <div class="info-card">
                    <div class="card-icon">ğŸš€</div>
                    <h3 class="card-title">Reducere Miss Penalty</h3>
                    <p class="card-text">Cache-uri multi-nivel, write buffers, early restart</p>
                </div>
            </div>
        </section>

        <section class="section" id="hit-time">
            <h2 class="section-title">OptimizÄƒri pentru Reducerea Hit Time</h2>

            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ”² Cache-uri L1 Mici È™i Simple</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                Cache-urile L1 sunt menÈ›inute mici (32-64 KB) pentru a permite acces Ã®n 
                                1-4 cicluri. Timpul de acces creÈ™te cu dimensiunea È™i asociativitatea.
                            </p>
                            <p><strong>Trade-off:</strong> Cache mic = hit time mic dar miss rate mai mare</p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ”€ Way Prediction</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                Prezice Ã®n ce "way" al setului se aflÄƒ datele Ã®nainte de a compara toate 
                                tag-urile. DacÄƒ predicÈ›ia e corectÄƒ, accesul e rapid ca la mapare directÄƒ. 
                                DacÄƒ e greÈ™itÄƒ, se verificÄƒ celelalte cÄƒi.
                            </p>
                            <p><strong>Beneficiu:</strong> Reduce timpul mediu de hit fÄƒrÄƒ a sacrifica asociativitatea</p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ“Š Pipelined Cache Access</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                Ãmparte accesul la cache Ã®n mai multe etape pipeline. Permite frecvenÈ›e 
                                mai mari, dar creÈ™te latenÈ›a efectivÄƒ pentru un singur acces.
                            </p>
                            <p><strong>Exemplu:</strong> Intel foloseÈ™te L1 pipelined Ã®n 3-4 cicluri pentru frecvenÈ›e GHz</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="miss-rate">
            <h2 class="section-title">OptimizÄƒri pentru Reducerea Miss Rate</h2>

            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ“¦ Cache-uri Mai Mari</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                Metoda directÄƒ pentru reducerea capacity miss-urilor. Dublarea dimensiunii 
                                reduce miss rate cu aproximativ 30% (legea empiricÄƒ).
                            </p>
                            <p><strong>Trade-off:</strong> Timp de acces mai mare, cost È™i consum energie mai mari</p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ”— Asociativitate Mai Mare</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                Reduce conflict miss-urile. Trecerea de la mapare directÄƒ la 2-way 
                                eliminÄƒ majoritatea conflictelor. Asociativitate > 8-way are beneficii 
                                marginale.
                            </p>
                            <p><strong>RegulÄƒ:</strong> 8-way â‰ˆ performanÈ›a complet asociativ pentru majoritatea aplicaÈ›iilor</p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ¯ Hardware Prefetching</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                Hardware-ul detecteazÄƒ pattern-uri de acces (de ex., stride constant) 
                                È™i aduce blocuri Ã®n cache Ã®nainte de a fi solicitate.
                            </p>
                            <table class="data-table">
                                <tr><td><strong>Sequential Prefetcher</strong></td><td>Aduce blocul urmÄƒtor automat</td></tr>
                                <tr><td><strong>Stride Prefetcher</strong></td><td>DetecteazÄƒ È™i urmÄƒreÈ™te stride-uri</td></tr>
                                <tr><td><strong>Stream Prefetcher</strong></td><td>UrmÄƒreÈ™te mai multe stream-uri simultane</td></tr>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ’» OptimizÄƒri Software (Compiler)</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <ul class="content-list">
                                <li><strong>Loop interchange:</strong> SchimbÄƒ ordinea buclelor pentru acces secvenÈ›ial</li>
                                <li><strong>Loop fusion:</strong> CombinÄƒ bucle pentru reutilizarea datelor Ã®n cache</li>
                                <li><strong>Loop tiling/blocking:</strong> Ãmparte datele pentru a Ã®ncÄƒpea Ã®n cache</li>
                                <li><strong>Software prefetching:</strong> InstrucÈ›iuni prefetch explicite</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ  Victim Cache</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                Un cache mic (4-16 linii), complet asociativ, care pÄƒstreazÄƒ liniile 
                                recent eliminate din L1. Reduce conflict miss-urile pentru mapare directÄƒ.
                            </p>
                            <div class="code-block">
<pre>La Miss L1:
1. CautÄƒ Ã®n Victim Cache
2. DacÄƒ gÄƒsit â†’ swap Ã®ntre L1 È™i Victim Cache
3. DacÄƒ nu â†’ aduce din L2, linia evacuatÄƒ merge Ã®n Victim</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="miss-penalty">
            <h2 class="section-title">OptimizÄƒri pentru Reducerea Miss Penalty</h2>

            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ—ï¸ Cache-uri Multi-Nivel</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                AdÄƒugarea L2, L3 reduce miss penalty-ul L1. Un miss Ã®n L1 poate fi 
                                servit de L2 Ã®n 10-20 cicluri vs 100+ cicluri pentru RAM.
                            </p>
                            <p>Miss Penalty efectiv L1 = HT_L2 + MR_L2 Ã— MP_L2</p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>âœï¸ Write Buffer</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                Un buffer care pÄƒstreazÄƒ scrierile Ã®n curs de procesare. Procesorul 
                                poate continua fÄƒrÄƒ sÄƒ aÈ™tepte finalizarea scrierii Ã®n memorie.
                            </p>
                            <p><strong>FuncÈ›ionare:</strong> Scrierea e plasatÄƒ Ã®n buffer â†’ procesorul continuÄƒ â†’ 
                            buffer-ul trimite datele la memorie Ã®n fundal</p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>â© Early Restart / Critical Word First</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                <strong>Early Restart:</strong> Procesorul primeÈ™te cuvÃ¢ntul cerut imediat 
                                ce ajunge, nu aÈ™teaptÄƒ Ã®ntreaga linie.
                            </p>
                            <p>
                                <strong>Critical Word First:</strong> Memoria trimite Ã®ntÃ¢i cuvÃ¢ntul cerut, 
                                apoi restul liniei (out-of-order delivery).
                            </p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ”„ Non-Blocking Cache</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                Cache-ul poate procesa noi accesuri Ã®n timp ce un miss este Ã®n curs 
                                ("hit under miss" sau "miss under miss"). EsenÈ›ial pentru execuÈ›ia 
                                out-of-order.
                            </p>
                            <p><strong>MSHR:</strong> Miss Status Handling Registers - urmÄƒresc miss-urile Ã®n curs</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="sumar">
            <h2 class="section-title">Rezumat</h2>
            <div class="info-box info-green">
                <p class="info-title">ğŸ“ Puncte Cheie</p>
                <ul class="content-list">
                    <li><strong>Hit Time:</strong> Cache-uri mici, way prediction, pipelining</li>
                    <li><strong>Miss Rate:</strong> Cache-uri mari, asociativitate, prefetching, optimizÄƒri software</li>
                    <li><strong>Miss Penalty:</strong> Multi-nivel, write buffers, early restart, non-blocking</li>
                    <li>ExistÄƒ trade-off-uri Ã®ntre diferite optimizÄƒri</li>
                    <li>CombinaÈ›ia optimÄƒ depinde de workload È™i constrÃ¢ngeri</li>
                </ul>
            </div>
        </section>
    </article>

    <script>
        document.querySelectorAll('.accordion-header').forEach(header => {
            header.addEventListener('click', () => {
                const content = header.nextElementSibling;
                const isExpanded = content.classList.contains('expanded');
                header.classList.toggle('active', !isExpanded);
                content.classList.toggle('expanded', !isExpanded);
            });
        });
    </script>
    <script src="../../js/lesson.js"></script>
</body>
</html>
