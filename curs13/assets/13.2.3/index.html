<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>13.2.3 - Mapare AsociativÄƒ</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/lesson.css">
</head>
<body>
    <article class="lesson-container">
        <header class="lesson-header">
            <span class="lesson-badge">LecÈ›ia 13.2.3</span>
            <h1 class="lesson-title">Mapare AsociativÄƒ</h1>
            <p class="lesson-subtitle">Cache-uri set-asociative È™i complet asociative</p>
        </header>

        <section class="section" id="introducere">
            <h2 class="section-title">Introducere</h2>
            <p class="text-content">
                Pentru a reduce conflict miss-urile din maparea directÄƒ, s-au dezvoltat scheme 
                mai flexibile care permit unui bloc sÄƒ fie stocat Ã®n <strong>mai multe locaÈ›ii</strong>. 
                Acestea includ cache-ul <strong>set-asociativ</strong> È™i cache-ul <strong>complet asociativ</strong>.
            </p>
        </section>

        <section class="section" id="set-asociativ">
            <h2 class="section-title">Cache Set-Asociativ (N-way)</h2>
            
            <div class="definition-box">
                <p class="definition-label">DefiniÈ›ie</p>
                <p class="definition-text">
                    Un cache <strong>N-way set-asociativ</strong> organizeazÄƒ liniile Ã®n <strong>seturi</strong>, 
                    fiecare set conÈ›inÃ¢nd N linii (N cÄƒi sau "ways"). Un bloc de memorie poate fi 
                    stocat Ã®n oricare dintre cele N linii ale setului corespunzÄƒtor.
                </p>
            </div>

            <p class="text-content">
                AceastÄƒ organizare reprezintÄƒ un compromis Ã®ntre maparea directÄƒ (1-way) È™i 
                maparea complet asociativÄƒ:
            </p>

            <div class="code-block">
<pre>Cache Set-Asociativ 4-way (exemplu)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        â”‚   Way 0   â”‚   Way 1   â”‚   Way 2   â”‚   Way 3   â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Set 0   â”‚ [Tag|Date]â”‚ [Tag|Date]â”‚ [Tag|Date]â”‚ [Tag|Date]â”‚
Set 1   â”‚ [Tag|Date]â”‚ [Tag|Date]â”‚ [Tag|Date]â”‚ [Tag|Date]â”‚
Set 2   â”‚ [Tag|Date]â”‚ [Tag|Date]â”‚ [Tag|Date]â”‚ [Tag|Date]â”‚
...     â”‚    ...    â”‚    ...    â”‚    ...    â”‚    ...    â”‚
Set N-1 â”‚ [Tag|Date]â”‚ [Tag|Date]â”‚ [Tag|Date]â”‚ [Tag|Date]â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Un bloc se poate stoca Ã®n oricare din cele 4 locaÈ›ii ale setului sÄƒu.</pre>
            </div>

            <h3>ÃmpÄƒrÈ›irea Adresei</h3>
            <div class="code-block">
<pre>Adresa Ã®n cache N-way set-asociativ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    TAG             â”‚ SET INDEX     â”‚ OFFSET      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“                    â†“              â†“
   Identificare         SelecteazÄƒ     Byte Ã®n
   + comparaÈ›ie         setul         linie
   cu N tag-uri</pre>
            </div>

            <p class="text-content">
                <strong>NumÄƒr seturi</strong> = NumÄƒr total linii / N (asociativitate)
            </p>
        </section>

        <section class="section" id="exemplu-set">
            <h2 class="section-title">Exemplu: Cache 4-way</h2>
            
            <table class="data-table">
                <tr><td><strong>Dimensiune totalÄƒ</strong></td><td>16 KB</td></tr>
                <tr><td><strong>Dimensiune linie</strong></td><td>64 bytes</td></tr>
                <tr><td><strong>Asociativitate</strong></td><td>4-way</td></tr>
                <tr><td><strong>NumÄƒr total linii</strong></td><td>256 (16 KB / 64 B)</td></tr>
                <tr><td><strong>NumÄƒr seturi</strong></td><td>64 (256 / 4)</td></tr>
            </table>

            <p class="text-content">
                Pentru o adresÄƒ de 32 biÈ›i:
            </p>
            <ul class="content-list">
                <li><strong>Offset:</strong> logâ‚‚(64) = 6 biÈ›i</li>
                <li><strong>Set Index:</strong> logâ‚‚(64) = 6 biÈ›i</li>
                <li><strong>Tag:</strong> 32 - 6 - 6 = 20 biÈ›i</li>
            </ul>

            <div class="info-box info-blue">
                <p class="info-title">ğŸ” FuncÈ›ionare</p>
                <p>
                    CÃ¢nd se cautÄƒ o adresÄƒ, hardware-ul: (1) foloseÈ™te indexul pentru a selecta setul, 
                    (2) comparÄƒ tag-ul adresei cu <strong>toate 4 tag-urile</strong> din set Ã®n paralel, 
                    (3) dacÄƒ un tag se potriveÈ™te È™i bitul valid este 1 â†’ HIT.
                </p>
            </div>
        </section>

        <section class="section" id="complet-asociativ">
            <h2 class="section-title">Cache Complet Asociativ</h2>
            
            <div class="definition-box">
                <p class="definition-label">DefiniÈ›ie</p>
                <p class="definition-text">
                    Un cache <strong>complet asociativ</strong> (fully associative) permite unui 
                    bloc sÄƒ fie stocat Ã®n <strong>oricare linie</strong> din cache. Nu existÄƒ index; 
                    Ã®ntreaga adresÄƒ (minus offset) serveÈ™te ca tag.
                </p>
            </div>

            <div class="code-block">
<pre>Adresa Ã®n cache complet asociativ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          TAG                 â”‚   OFFSET    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“                       â†“
    ComparÄƒ cu TOATE              Byte Ã®n
    tag-urile din cache           linie</pre>
            </div>

            <div class="card-grid">
                <div class="info-card">
                    <div class="card-icon">âœ…</div>
                    <h3 class="card-title">Avantaje</h3>
                    <p class="card-text">
                        â€¢ Zero conflict miss-uri<br>
                        â€¢ Rata de hit maximÄƒ pentru dimensiunea datÄƒ<br>
                        â€¢ Flexibilitate completÄƒ Ã®n plasare
                    </p>
                </div>
                <div class="info-card">
                    <div class="card-icon">âŒ</div>
                    <h3 class="card-title">Dezavantaje</h3>
                    <p class="card-text">
                        â€¢ Hardware complex (comparatoare paralele)<br>
                        â€¢ Cost È™i consum de energie ridicate<br>
                        â€¢ Timp de acces mai mare<br>
                        â€¢ Practic doar pentru cache-uri mici (TLB)
                    </p>
                </div>
            </div>
        </section>

        <section class="section" id="comparatie">
            <h2 class="section-title">ComparaÈ›ie Ã®ntre Tipuri</h2>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>CaracteristicÄƒ</th>
                        <th>Mapare DirectÄƒ</th>
                        <th>N-way Set-Asociativ</th>
                        <th>Complet Asociativ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>LocaÈ›ii posibile</strong></td>
                        <td>1</td>
                        <td>N</td>
                        <td>Toate</td>
                    </tr>
                    <tr>
                        <td><strong>ComparaÈ›ii necesare</strong></td>
                        <td>1</td>
                        <td>N (paralel)</td>
                        <td>Toate (paralel)</td>
                    </tr>
                    <tr>
                        <td><strong>Conflict miss-uri</strong></td>
                        <td>Multe</td>
                        <td>Reduse</td>
                        <td>Zero</td>
                    </tr>
                    <tr>
                        <td><strong>Complexitate HW</strong></td>
                        <td>MinimÄƒ</td>
                        <td>ModeratÄƒ</td>
                        <td>MaximÄƒ</td>
                    </tr>
                    <tr>
                        <td><strong>Utilizare tipicÄƒ</strong></td>
                        <td>Cache simplu</td>
                        <td>L1, L2, L3</td>
                        <td>TLB, cache mic</td>
                    </tr>
                </tbody>
            </table>

            <div class="info-box">
                <p class="info-title">ğŸ“Š Regula PracticÄƒ</p>
                <p>
                    Dublarea asociativitÄƒÈ›ii are aproximativ acelaÈ™i efect asupra ratei de miss 
                    ca dublarea dimensiunii cache-ului. Asociativitatea 8-way este de obicei 
                    suficientÄƒ pentru a elimina majoritatea conflict miss-urilor.
                </p>
            </div>
        </section>

        <section class="section" id="hardware">
            <h2 class="section-title">Implementare Hardware</h2>
            
            <p class="text-content">
                Hardware-ul pentru cache set-asociativ necesitÄƒ:
            </p>

            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ”Œ Comparatoare Paralele</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                Pentru un cache N-way, sunt necesare N comparatoare care funcÈ›ioneazÄƒ 
                                Ã®n paralel pentru a compara tag-ul adresei cu toate tag-urile din set. 
                                Rezultatele sunt combinate cu OR pentru a determina hit/miss.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ”€ Multiplexor de Date</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                Un multiplexor N:1 selecteazÄƒ datele din calea care a generat hit. 
                                Semnalele de control sunt generate de comparatoare.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ“‹ LogicÄƒ de Ãnlocuire</span>
                        <span class="icon-plus">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-body">
                            <p>
                                La miss, trebuie selectatÄƒ o linie pentru Ã®nlocuire. Aceasta necesitÄƒ 
                                hardware suplimentar pentru implementarea politicii de Ã®nlocuire 
                                (LRU, Random, etc.).
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="sumar">
            <h2 class="section-title">Rezumat</h2>
            <div class="info-box info-green">
                <p class="info-title">ğŸ“ Puncte Cheie</p>
                <ul class="content-list">
                    <li><strong>Set-asociativ N-way:</strong> fiecare bloc poate fi Ã®n N locaÈ›ii ale setului sÄƒu</li>
                    <li><strong>Complet asociativ:</strong> fiecare bloc poate fi oriunde Ã®n cache</li>
                    <li>Asociativitate mai mare = mai puÈ›ine conflict miss-uri</li>
                    <li>Asociativitate mai mare = hardware mai complex È™i mai lent</li>
                    <li>8-way este compromisul optim pentru majoritatea aplicaÈ›iilor</li>
                </ul>
            </div>
        </section>
    </article>

    <script>
        document.querySelectorAll('.accordion-header').forEach(header => {
            header.addEventListener('click', () => {
                const content = header.nextElementSibling;
                const isExpanded = content.classList.contains('expanded');
                header.classList.toggle('active', !isExpanded);
                content.classList.toggle('expanded', !isExpanded);
            });
        });
    </script>
    <script src="../../js/lesson.js"></script>
</body>
</html>
